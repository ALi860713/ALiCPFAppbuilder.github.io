
	
	setup();
	
	var temp;
	var now_press;
	var prev_press;
	var total = 0;
	
	setInterval(loop, 1000);
	
	function loop() {
	
		temp = cpf.get("socket a1");
		now_press = cpf.get("socket a0");
		
		document.getElementById("test").innerHTML = temp;
		document.getElementById("temp").innerHTML = toCelsius(temp) + '℃';
		document.getElementById("weight").innerHTML = (now_press * 2) + '公克';
		
		if(now_press == 0) {
			if(now_press < prev_press) {
				total += prev_press - now_press;
			}
		} else {
			prev_press = now_press;
		}
		
		if(total >= 400) {
			document.getElementById("cup1").src = './images/cup_empty.png';
			document.getElementById("cup2").src = './images/cup_full.png';
			document.getElementById("cup3").src = './images/cup_full.png';
			document.getElementById("cup4").src = './images/cup_full.png';
			document.getElementById("cup5").src = './images/cup_full.png';
		} else if(total >= 800) {
			document.getElementById("cup1").src = './images/cup_empty.png';
			document.getElementById("cup2").src = './images/cup_empty.png';
			document.getElementById("cup3").src = './images/cup_full.png';
			document.getElementById("cup4").src = './images/cup_full.png';
			document.getElementById("cup5").src = './images/cup_full.png';
		} else if(total >= 1200) {
			document.getElementById("cup1").src = './images/cup_empty.png';
			document.getElementById("cup2").src = './images/cup_empty.png';
			document.getElementById("cup3").src = './images/cup_empty.png';
			document.getElementById("cup4").src = './images/cup_full.png';
			document.getElementById("cup5").src = './images/cup_full.png';
		} else if(total >= 1600) {
			document.getElementById("cup1").src = './images/cup_empty.png';
			document.getElementById("cup2").src = './images/cup_empty.png';
			document.getElementById("cup3").src = './images/cup_empty.png';
			document.getElementById("cup4").src = './images/cup_empty.png';
			document.getElementById("cup5").src = './images/cup_full.png';
		} else if(total >= 2000) {
			document.getElementById("cup1").src = './images/cup_empty.png';
			document.getElementById("cup2").src = './images/cup_empty.png';
			document.getElementById("cup3").src = './images/cup_empty.png';
			document.getElementById("cup4").src = './images/cup_empty.png';
			document.getElementById("cup5").src = './images/cup_empty.png';
		} else {
			document.getElementById("cup1").src = './images/cup_full.png';
			document.getElementById("cup2").src = './images/cup_full.png';
			document.getElementById("cup3").src = './images/cup_full.png';
			document.getElementById("cup4").src = './images/cup_full.png';
			document.getElementById("cup5").src = './images/cup_full.png';
		}
		
		document.getElementById("cup_value").innerHTML = total;
		
	}
		
	function toCelsius(value) {
		var steinhart = value / 10000.0;
		steinhart = Math.log(steinhart);
		steinhart /= 3950.0;
		steinhart += 1.0 / (25 + 273.15);
		steinhart = 1.0 / steinhart;
		steinhart -= 273.15;
			
		return steinhart.toFixed(0);
	}
	
	// cpf setup
	function setup(){
		if(cpf)
			var ret = cpf.setPinMode('["resetPin"],["setPinMode", "analog", 0, "INPUT"],["setPinMode", "analog", 1, "INPUT"]');
		
	}

